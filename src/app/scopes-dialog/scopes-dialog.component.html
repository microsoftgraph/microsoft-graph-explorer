<dialog id="scopes-dialog" #scopesDialog (keyup.esc)="closeModal()">
    <button
        autofocus
        tabindex="0"
        id="scopes-dialog-button"
        class="ms-Dialog-button ms-Dialog-buttonClose"
        (click)="closeModal()"
        (keyup.enter)="closeModal()"
        #scopesDialog
    >
        <i class="ms-Icon ms-Icon--Cancel"></i>
    </button>
    <div tabindex="0" class="ms-Dialog-title" id="dialog-title">{{getStr('modify permissions')}}</div>
    <p class="ms-Dialog-subText" tabindex="0">
        Select different
        <a
            class="ms-Link"
            href="https://developer.microsoft.com/graph/docs/concepts/permissions_reference"
            target="_blank"
        >
            permissions
        </a>
        to try out Microsoft Graph API endpoints.</p>
    <div class="ms-Dialog-content">
        <div tabindex="0" id="scopes-list-table-container" #scopesListTableContainer [style.height.px]="getScopesListTableHeight()">
            <ul id="scopes-list-table">
                <li class="scope-row" *ngFor="let scope of scopes" tabindex="-1">
                    <div tabindex="0" class="c-checkbox">
                        <label class="c-label">
                            <input
                              type="checkbox"
                              [disabled]="scope.enabled"
                              (change)="toggleRequestScope(scope)"
                              (keyup.enter)="toggleRequestScope(scope)"
                              name="checkboxId1"
                              value="value1" [attr.aria-label]="getScopeLabel(scope.name)">
                              <span aria-hidden="true" [title]="scope.description">{{scope.name}}
                                <i class="consented-label" *ngIf="scope.enabled">{{getStr('Consented')}}</i>
                                <i class="preview-label" *ngIf="scope.preview">{{getStr('Preview')}}</i>
                              </span>
                              <span *ngIf="scope.admin" class="admin-scope">
                                Admin
                              </span>
                        </label>
                    </div>
                </li>
            </ul>
        </div>
        <div *ngIf="scopeListIsDirty()">
            <div class="ms-MessageBar ms-MessageBar--warning">
                <div class="ms-MessageBar-content">
                    <div class="ms-MessageBar-icon">
                        <i class="ms-Icon ms-Icon--Info"></i>
                    </div>
                    <div class="ms-MessageBar-text" role="alert" aria-live="assertive">
                        {{getStr('To change permissions, you will need to log-in again.')}}
                        <br />
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="hasSelectedAdminScope">
            <div class="ms-MessageBar ms-MessageBar--warning">
                <div class="ms-MessageBar-content">
                    <div class="ms-MessageBar-icon">
                        <i class="ms-Icon ms-Icon--Info"></i>
                    </div>
                    <div class="ms-MessageBar-text" role="alert" aria-live="assertive">
                        You have selected permissions that only an administrator can grant. To get access, an
                        administrator can grant
                        <a class="ms-Link" href="#" [style.font-size.px]="15" (click)="startAdminConsentFlow()">access
                            to your entire organization</a>.
                        <br />
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="ms-Dialog-actions">
        <button class="ms-Button ms-Dialog-action ms-Button--primary" [disabled]="!scopeListIsDirty()" (click)="getNewAccessToken()">
            <span class="ms-Button-label" style="text-transform: capitalize;">{{getStr('modify permissions')}}</span>
        </button>
        <button
            class="ms-Button ms-Dialog-action"
            (keyup.enter)="closeModal()"
            (click)="closeModal()"
        >
            <span class="ms-Button-label">{{getStr('Close')}}</span>
        </button>
    </div>
</dialog>